syntax = "proto3";

option go_package = "./training";

package training;

//基础功能
message DictInfoByTypeReq {
  string key = 1;
}
message DictInfoByTypeResp {
  repeated DictInfo list = 1;
}
message DictInfo {
  string name = 1;
  string value = 2;
  int64  orderNum = 3;
}
service BasicFunction {
  rpc getDictInfoByType(DictInfoByTypeReq) returns (DictInfoByTypeResp);
}

//知识库训练 暂未开发
message KnowledgeBaseTrainingReq {
}
message KnowledgeBaseTrainingResp {
}
service KnowledgeBaseTraining {
  rpc preSetting(KnowledgeBaseTrainingReq) returns (KnowledgeBaseTrainingResp);
}

// 店铺训练
// 判断店铺是否首次登录请求体 即从未进行过训练
message JudgeShopFirstReq {
  int64 userId = 1; // 用户id
  string uuid = 2; // 店铺uuid
}
// 判断店铺是否首次登录返回体
message JudgeShopFirstResp {
  int64 first = 1;
}

// 分页查询店铺列表请求体
message ShopPageListReq {
  int64  pageNum = 1;
  int64  pageSize = 2;
  string query = 3;
  int64  userId = 4;
  int64  platFormType = 5;
  int64  trainingStatus = 6;
  int64  updateTime = 7;
}
// 店铺分页列表返回体
message ShopPageListResp {
  int64 pageNum = 1;
  int64 pageSize = 2;
  int64 total = 3;
  repeated ShopResp list = 4;
}
// 单条店铺数据返回体
message ShopResp {
  int64  id = 1;
  string uuid = 2;
  string shopName = 3;
  int64  platformType = 4;
  int64  trainingStatus = 5;
  int64  trainingTimes = 6;
  int64  updateTime = 7;
}

message PreSettingShopReq {
  int64 userId = 1;
  string uuid = 2;
  string shopName = 3;
  int64 platformType = 4;
  string authorization = 5;
  string cookies = 6;
}
message PreSettingShopResp {
  string result = 1;
}
message CancelPreSettingReq {
  int64 userId = 1;
  string uuid = 2;
}

message GoodsPageListReq {
  int64  shopId = 1;
  int64  pageNum = 2;
  int64  pageSize = 3;
  string query = 4;
  int64  enabled = 5;
  int64  updateTime = 6;
}
message GoodsResp {
  int64  id = 1;
  int64  shopId = 2;
  string goodsName = 3;
  string goodsUrl = 4;
  string trainingSummary = 5;
  int64  enabled = 6;
  int64  trainingStatus = 7;
  int64  trainingTimes = 8;
  int64  updateTime = 9;
}
message GoodsPageListResp {
  int64 pageNum = 1;
  int64 pageSize = 2;
  int64 total = 3;
  repeated GoodsResp list = 4;
}
message GoodsTrainingReq {
  int64 goodsId = 1;
}
message GoodsTrainingResp {
  string result = 1;
}
message TrainingShopReq {
  string uuid = 1;
  int64 userId = 2;
}
message TrainingShopResp {
  string result = 1;
}
message GetShopTrainingProgressReq {
  string uuid = 1;
  int64 userId = 2;
}
message GetShopTrainingProgressResp {
  int64 training_status = 1; // 训练状态 0: 初始 1: 预设中 2: 预设完成 11: 训练中 12: 训练完成
  int64 goods_num = 2;       // 商品数量
  int64 token = 3;           // 训练token
  int64 file_size = 4;       // 文件大小
  int64 power = 5;           // 训练算力
  int64 time = 6;            // 训练耗时
}
message PreSettingGoodsReq {
  int64 goodsId = 1;
  int64 userId = 2;
  string authorization = 5;
  string cookies = 6;
}
message PreSettingGoodsResp {
  string result = 1;
}
message CancelPreSettingGoodsReq {
  int64 goodsId = 1;
  int64 userId = 2;
}
message CancelPreSettingGoodsResp {
  string result = 1;
}
message TrainingGoodsReq {
  int64 goodsId = 1;
  int64 userId = 2;
}
message TrainingGoodsResp {
  string result = 1;
}
message GetGoodsTrainingProgressReq {
  int64 goodsId = 1;
  int64 userId = 2;
}
message GetGoodsTrainingProgressResp {
  int64 training_status = 1; // 训练状态 0: 初始 1: 预设中 2: 预设完成 11: 训练中 12: 训练完成
  int64 goods_num = 2;       // 商品数量
  int64 token = 3;           // 训练token
  int64 file_size = 4;       // 文件大小
  int64 power = 5;           // 训练算力
  int64 time = 6;            // 训练耗时
}
message AddGoodsReq {
  int64 shopId = 1;
  repeated string list = 2; // 商品url列表
  int64 userId = 3;
}
message AddGoodsResp {
  string result = 1;
}
message GetGoodsTrainingResultReq {
  int64 goodsId = 1;
}
message GetGoodsTrainingResultResp {
  string result = 1;
}
message SaveShopReq {
  int64 userId = 1;
  string serialNumber = 2;
  string uuid = 3;
  string shopName = 4;
  int64 platformType = 5;
  repeated SaveGoods list = 6;
}
message SaveGoods {
  string platformId = 1;
  string goodsName = 2;
  string goodsUrl = 3;
}
message SaveShopResp {
  string result = 1;
}
service ShopTraining {
  // 判断店铺是否首次登录 即从未进行过训练
  rpc judgeShopFirst(JudgeShopFirstReq) returns (JudgeShopFirstResp);

  // 预设店铺
  rpc preSettingShop(PreSettingShopReq) returns (PreSettingShopResp);
  // 取消店铺预设
  rpc cancelPreSetting(CancelPreSettingReq) returns (PreSettingShopResp);

  // 查询店铺列表
  rpc getShopPageList(ShopPageListReq) returns (ShopPageListResp);
  // 训练店铺
  rpc trainingShop(TrainingShopReq) returns (TrainingShopResp);
  // 获取店铺训练进度
  rpc getShopTrainingProgress(GetShopTrainingProgressReq) returns (GetShopTrainingProgressResp);


  // 查询商品列表
  rpc getGoodsPageList(GoodsPageListReq) returns (GoodsPageListResp);
  // 获取商品训练结果
  rpc getGoodsTrainingResult(GetGoodsTrainingResultReq) returns (GetGoodsTrainingResultResp);
  // 预设商品
  rpc preSettingGoods(PreSettingGoodsReq) returns (PreSettingGoodsResp);
  // 取消预设商品
  rpc cancelPreSettingGoods(CancelPreSettingGoodsReq) returns (CancelPreSettingGoodsResp);
  // 训练商品
  rpc trainingGoods(TrainingGoodsReq) returns (TrainingGoodsResp);
  // 获取商品训练进度
  rpc getGoodsTrainingProgress(GetGoodsTrainingProgressReq) returns (GetGoodsTrainingProgressResp);
  // 添加商品
  rpc addGoods(AddGoodsReq) returns (AddGoodsResp);
  // 启用商品
  rpc enableGoods(GoodsTrainingReq) returns (GoodsTrainingResp);
  // 禁用商品
  rpc unEnableGoods(GoodsTrainingReq) returns (GoodsTrainingResp);
  // 保存爬取的店铺基本数据
  rpc saveShop(SaveShopReq) returns (SaveShopResp);
}