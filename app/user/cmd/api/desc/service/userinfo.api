syntax = "v1"

info(
    title: "用户信息服务"
    desc: "用户信息服务"
    author: "zouxiaodong"
    email: "13575232531@163.com"
    version: "v1"
)

import (
    "basefunction.api"
)

// 登录注册服务
type (
    // 获取图形验证码返回体
    CaptchaResp {
        BaseResp
        Data CaptchaData `json:"data"` // 图形验证码信息
    }

        // 图形验证码信息
    CaptchaData {
        CaptchaId string `json:"captchaId"`   // 验证码ID
        CaptchaImg string `json:"captchaImg"` // 验证码图片
    }

        // 获取手机验证码请求体
    VerificationCodeReq {
        Phone string `json:"phone"` // 手机号码
    }

        // 注册请求体
    RegisterReq {
        Phone string `json:"phone"`                      // 手机号码
        VerificationCode string `json:"verificationCode"`// 手机验证码
        CaptchaId string `json:"captchaId"`              // 验证码ID
        Answer string `json:"answer"`                    // 验证码答案
    }

        // 注册返回体
    RegisterResp {
        BaseResp
        Data UserInfo `json:"data"` // 用户信息
    }

        // 登录/注册成功后返回的用户信息
    UserInfo {
        Token string `json:"token"`       // JWT Token
        Phone string `json:"phone"`       // 手机号码
        NickName string `json:"nickname"` // 昵称
        HeadImg string `json:"headImg"`   // 头像
    }
        // 登录请求体
    LoginReq {
        Phone string `json:"phone"`                           // 手机号码
        VerificationCode string `json:"verificationCode"`     // 手机验证码
        CaptchaId string `json:"captchaId"`                   // 验证码ID
        Answer string `json:"answer"`                         // 验证码答案
        ThirtyDaysFreeLogin bool `json:"thirtyDaysFreeLogin"` // 是否30天免登录
    }

        // 登录返回体
    LoginResp {
        BaseResp
        Data UserInfo `json:"data"` // 用户信息
    }

        // 获取登录二维码返回体
    LoginQrCodeResp {
        BaseResp
        Data LoginQrCodeData `json:"data"` // 登录二维码内容
    }

        // 登录二维码内容
    LoginQrCodeData {
        TicketQrCodeUrl string `json:"ticketQrCodeUrl"` // 二维码图片链接
        Ticket string `json:"ticket"`                   // 二维码票据
    }

        // 微信扫码登录状态请求体
    QrCodeLoginStatusReq {
        Ticket string `json:"ticket"`                         // 二维码票据
        ThirtyDaysFreeLogin bool `json:"thirtyDaysFreeLogin"` // 是否30天免登录
    }

        // 微信扫码登录状态返回体
    QrCodeLoginStatusResp {
        BaseResp
        Data UserInfo `json:"data"` // 用户信息
    }
)

type (
    // 文件上传响应
    FileUploadResp {
        BaseResp
        Data string `json:"data"` // 文件对象Key
    }

        // 文件下载请求
    FileDownloadReq {
        ObjectKey string `json:"objectKey"` // 文件对象Key
    }

        // 获取当前登录用户数据返回体
    CurrentUserDataResp {
        BaseResp
        Data CurrentUserData `json:"data"` // 当前登录用户数据
    }

        // 当前登录用户数据
    CurrentUserData {
        Token string `json:"token"`                  // JWT Token
        Phone string `json:"phone"`                  // 手机号码
        NickName string `json:"nickname"`            // 昵称
        HeadImg string `json:"headImg"`              // 头像
        NowOrg OrgInfo `json:"nowOrg"`               // 当前组织信息
        UnreadMsgCount int64 `json:"unreadMsgCount"` // 未读消息数量
    }

        // 绑定手机号请求体
    BindPhoneReq {
        Phone string `json:"phone"`                           // 手机号码
        VerificationCode string `json:"verificationCode"`     // 手机验证码
        ThirtyDaysFreeLogin bool `json:"thirtyDaysFreeLogin"` // 是否30天免登录
    }

        // 绑定手机号返回体
    BindPhoneResp {
        BaseResp
        Data UserInfo `json:"data"` // 用户信息
    }

        // 用户组织列表返回体
    OrgListResp {
        BaseResp
        Data []OrgInfo `json:"data"` // 组织列表
    }

        // 组织信息
    OrgInfo {
        OrgId string `json:"orgId"`           // 组织ID
        OrgName string `json:"orgName"`       // 组织名称
        BundleType int64 `json:"bundleType"`  // 套餐类型 0: 免费版 1: 基础版 2: AI个人版 3: AI协作版
        IsAdmin bool `json:"isAdmin"`         // 是否是管理员
    }

        // 切换组织请求体
    ChangeOrgReq {
        OrgId string `json:"orgId"` // 组织ID
    }

        // 更新组织名称请求体
    UpdateOrgNameReq {
        OrgId string `json:"orgId"`     // 组织ID
        OrgName string `json:"orgName"` // 新组织名称
    }

        // 更新头像请求体
    UpdateHeadImgReq {
        HeadImg string `json:"headImg"` // 新头像URL
    }

        // 更新昵称请求体
    UpdateNickNameReq {
        NickName string `json:"nickName"` // 新昵称
    }

        // 获取消息列表请求体
    MessageListReq {
        MessageId string `json:"messageId"`  // 消息ID
        TimeVector int64 `json:"timeVector"` // 时间向量 0: 新消息 1: 旧消息
    }

        // 获取消息列表返回体
    MessageListResp {
        BaseResp
        Data []MessageInfo `json:"data"` // 消息列表
    }

        // 消息内容
    MessageInfo {
        MessageId string `json:"messageId"`                      // 消息ID
        MessageContentType int64 `json:"messageContentType"`     // 消息内容类型 0: 文字 1: 图文 2: 图片 3: 邀请加入组织 4: 申请加入组织 5: 平台掉线 6: 算力不足 7: 转接失败
        MessageContent string `json:"messageContent"`            // 消息内容
        DealFlag int64 `json:"dealFlag"`                         // 处理标记 0: 未处理 1: 已处理
        IgnoreFlag int64 `json:"ignoreFlag"`                     // 忽略标记 0: 未忽略 1: 已忽略
        CreateTime int64 `json:"createTime"`                     // 创建时间
    }

        // 忽略消息请求体
    IgnoreMessageReq {
        MessageId string `json:"messageId"` // 消息ID
    }
)

// 微信回调接口
type (
    // 微信回调请求体
    WechatCallBackGetReq {
        Signature string `form:"signature"`   // 微信加密签名，signature结合了开发者填写的token参数和请求中的timestamp参数、nonce参数。
        Timestamp string `form:"timestamp"`   // 时间戳
        Nonce string `form:"nonce"`           // 随机数
        Echostr string `form:"echostr"`       // 随机字符串
    }

        // 微信回调请求体
    WechatCallBackPostSignReq {
        Signature string `form:"signature"`   // 微信加密签名，signature结合了开发者填写的token参数和请求中的timestamp参数、nonce参数。
        Timestamp string `form:"timestamp"`   // 时间戳
        Nonce string `form:"nonce"`           // 随机数
    }

        // 微信回调请求体
    WechatCallBackPostReq {
        Signature string `json:"signature"`        // 微信加密签名，signature结合了开发者填写的token参数和请求中的timestamp参数、nonce参数。
        Timestamp string `json:"timestamp"`        // 时间戳
        Nonce string `json:"nonce"`                // 随机数

        ToUserName string `json:"ToUserName"`      // 开发者微信号
        FromUserName string `json:"FromUserName"`  // 发送方帐号（一个OpenID）
        CreateTime int64 `json:"CreateTime"`       // 消息创建时间 （整型）
        MsgType string `json:"MsgType"`            // 消息类型，event
        Event string `json:"Event"`                // 事件类型 subscribe 或 SCAN
        EventKey string `json:"EventKey"`          // 事件KEY值
        Ticket string `json:"Ticket"`              // 二维码的ticket，可用来换取二维码图片
    }
)